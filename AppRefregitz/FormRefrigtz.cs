/***********************************************************************************************
 * Main class of Form Inherited of Form Main in the C#.*****************************************
 * Ramin Edjlal*******************************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Mouse Event Handling Error*****************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Some Soldiers Loos Location  And Virutuallization at Click*********************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Some Codes Lines Frizes********************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Hit things Abnormal behaviour**************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Virtualization Things Error****************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * No Reason Logically For Equality of 'SoldierP' and 'Soldier'*******************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Problem of Sameness of Hit Enemys Solved.No Reason For Equality of 'Soldier' and 'SoldierP'RS--************(-+)
 * No Problem For Hiting**********************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Bridges of Gray Color Conversion to Kings Brown********************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Bridges Conversion To King Brown Abnormally no Reasonably**********************************CU*****0.88**1**Risk Control************************(*)
 * Color Conversion In Virtualization Hit Enemy***********************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Need To Find Enemy Detection on Current OrderPlate*****************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * CheckMate an Check Dosn't Work*******************************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * No Movments By Computer********************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Illegal Virtualization. The Thinking By 'Alice' (My Computer) ChessRules Misleading********RS*****0.12**4**Managements and Cuation Programing**(+)
 * permutative Constant Huristic Results******************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * In Existence of Adding Suported Huristic Constant Huristic Result Detection****************RS*****0.12**4**Managements and Cuation Programing**(+)
 * OrderPlate Not Configured******************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Non Color Hourse Hit Assignment Misleading(Abnormal)***************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Undetected Error Table Content Malfunction*************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * MalFunction Movments Greate than 5 by 'Alice'.*********************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * 'Check' Second Time 'Alice' MalFanction*****************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * 'Check' 'Alice' Mechnisam Failure***********************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 '* CheckMate' of Unsatisfied in 'Alice'***********************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * CheckMate Dosn't Recognized.********************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Virtualization Filed (Not Responding) at Indpencdency State********************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Unable To Draw Refrigtz.Timer  Content at Tow Picture Box*******************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Refrigtz.Timer Working Hardly.**********************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Dead Lock In Drawing Images.***************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Misleading Thread OrderPlate And Time Sharing**********************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Thinkings Taking a lot of Time.************************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * AntiVirus Protextion and Existance Caused to Reduce Speed of Thinking and lead to Lose.****RS*****0.12**4**Managements and Cuation Programing**(+)
 * No Programatically Reason For Speed Reduction.*********************************************RS*****0.12**4**Managements and Cuation Programing**(+) 
 * Mybe Windows Filrewall Has no been correctly Arranges to reduce speed.*********************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Method on Leave not Work.******************************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * OrderPlate Reader Table MalFunction.*******************************************************RS*****0.12**4**Managements and Cuation Programing**(+)
 * Wrong Sysntax To Read.*********************************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Some Tables of Hitting Tow Person Are Missing.*********************************************__**************(_)
 * Some Syntaxes at Table Read Are Missing.***************************************************__**************(_)
 * Chess Refregitz Sometimes Not Responding due to Cpu Power Non Ability.*********************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Chess Refregitz Sometimes stop working.****************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * 1395/1/16**********************************************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * OrderPlate MalFunction.********************************************************************RS*****0.12**4**Managements and Cuation Programing**{+}
 * Virtualization Error.No Reason For MalFunctionla Operation of Program at Sysntax and Orde.*CU*****0.88**1**Risk Control************************{*}QC-OK.
 * Cause Sensitive Problems of 'Check' And 'CheckMate By 'Alice' is borring at StateCP.*************CU*****0.88**1**Risk Control************************{*}QC-OK.
 * Table Content Misleading.******************************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Documentation Faulting On Removing Detials.************************************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Loading Games  to Continue failed Unreasonly.**********************************************CU*****0.88**1**Risk Control************************<*>QC-OK.
 * "Thread is dead.The state can not be accessed.".*******************************************CU*****0.88**1**Risk Control************************{*}QC-OK.
 * Illegal Syntax Mechanisam Detection By Genetic Algorithm.**********************************CU*****0.88**1**Risk Control************************<*>QC-Ok.
 * 'MaxCurrentMovmentsNumber' Changes Illegal to Reduced.*************************************CU*****0.88**1**Risk Control************************{*}QC-OK.
 * Arranagment Up-Down Changes caused to Born of Some Objects UnSupported Attractively.*******CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Table TableListAction Genetic Algorithm MalFunctionally Illegal Data.**********************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Bridges King Insertion Overllaping Previous Enemy Movments of Person Movments.*************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Statisticer Loader and Acter Bridges King Overview Failed.*********************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Bridges King Continue With Illegal Movments at Statisticer.********************************CU*****0.88**1**Risk Control************************(*)QC-OK.
 * Calling of All Events From Pressing a Single Button.Mal Function of Database Leading.******CU*****0.88**1**Risk Control************************<*>
 * ***********************************************************************************************************
 * ***********************************************************************************************************
 */


using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.Threading;



namespace AppRefregitz
{
    //Constructor
    public partial class FormRefrigtz
    {

        //Initiate Global Variable.
        //public bool DisableTemporarlyTimerUpdate = false;
        bool IsPenaltyRegardCanceled = false;
        public static bool LoadPlaceHolder = true;
        public bool PlaceHolderBreak = false;
        public static bool ThinkingA = false;
        public static bool ReadF = false;
        bool BobWithStockfishFinished = false;
        bool Stockfish = false;
        bool RefregitzisCurrent = true;
        bool SettingPRFALSE = false;
        public static bool ProfesionalWithComputer = false;
        public bool TimersSet = true;
        public static bool GameStarted = false;
        public static bool ArrangmentsChanged = false;
        public static int MaxCurrentMovmentsNumber = 1;
        public static bool ErrorTrueMonitorFalse = true;
        Thread tM = null;
        bool Clicked = true;
        public static int MaxAStarGreedyHuristicProgress = 0;
        public bool MouseClicked = false;
        public static bool Blitz = false;
        DateTime PreviousTime;
        static bool LoadAG = false;
        static bool _1 = false;
        static bool _2 = false;
        static bool _3 = false;
        static bool _4 = false;
        static bool Hideag = false;
        bool exit = false;
        bool AllDrawLoad = false;
        Thread AllOperate = null;
        static bool Paused = false;
        static bool UpdateConfigurationTableVal = false;
        static bool NewTable = false;
        public static int LastRow = -1;
        public static int LastColumn = -1;
        Thread t1 = null;
        Thread t2 = null;
        Thread t3 = null;
        Thread t4 = null;
        Thread TTimerSet;
        public static bool LoadedTable = false;
        bool GrayWinner = false;
        bool BrownWiner = false;
        public Refrigtz.Timer TimerText = null;
        public Refrigtz.Timer GrayTimer = null;
        public Refrigtz.Timer BrownTimer = null;
        public static int MovmentsNumber = 0;
        public static bool EndOfGame = false;
        bool Maximize = false;
        static int RowP = 0, ColP = 0, RowS = 0, ColS = 0;
        bool BobSection = true;
        bool AliceSection = false;
        public static bool Person = true;
        static int CurrentKind = 0;
        public static bool StateCC = false;//Computer With Computer
        public static bool StateCP = false;//Person With Computer
        public static bool StateGe = false;//For Genetic Games.
        AllDraw Draw;
        public static int OrderPlate = 1;
        // int AllDraw.MouseClick;
        int Soldier;
        int Elefant;
        int Hourse;
        int Bridge;
        int Minister;
        int King;
        float RowClickP = -1, ColumnClickP = -1;
        int RowClick = -1, ColumnClick = -1;
        float RowRealesedP = -1, ColumnRealeasedP = -1;
        float RowRealesed = -1, ColumnRealeased = -1;
        public static int[,] Table = new int[8, 8];
        FormRefrigtz THIs = null;
        //Constructor No2
        public FormRefrigtz(bool AllDra)
        {

            AllDrawLoad = AllDra;

            if (!AllDrawLoad)
            {

                t1 = new Thread(new ThreadStart(AliceWithPerson));
          
            }


            THIs = this;
            Draw = new AllDraw(ref THIs);

            if (!AllDrawLoad)
            {
                BrownTimer = new Refrigtz.Timer(false);
                GrayTimer = new Refrigtz.Timer(false);
                TimerText = new Refrigtz.Timer(true);

                BrownTimer.TimerInitiate();
                GrayTimer.TimerInitiate();
                TTimerSet = new Thread(new ThreadStart(SetTimer));
                TTimerSet.Start();

                TimerText.TimerInitiate();

                TimerText.StartTime();
            }
           
            if (!AllDrawLoad)
            {
                for (int i = 0; i < 8; i++)
                    for (int j = 0; j < 8; j++)
                    {
                        Table[i, j] = 0;
                    }

                for (int i = 0; i < 8; i++)
                    Table[i, 1] = 1;

                for (int i = 8; i < 16; i++)
                    Table[i - 8, 6] = -1;
                Table[2, 0] = 2;
                Table[5, 0] = 2;
                Table[2, 7] = -2;
                Table[5, 7] = -2;

                Table[1, 0] = 3;
                Table[6, 0] = 3;
                Table[1, 7] = -3;
                Table[6, 7] = -3;

                Table[0, 0] = 4;
                Table[7, 0] = 4;
                Table[0, 7] = -4;
                Table[7, 7] = -4;

                Table[3, 0] = 6;
                Table[3, 7] = -6;

                Table[4, 0] = 5;
                Table[4, 7] = -5;
            }
            for (int i = 0; i < 8; i++)
                for (int j = 0; j < 8; j++)
                {
                    AllDraw.TableVeryfy[i, j] = Table[i, j];
                    AllDraw.TableVeryfyConst[i, j] = Table[i, j];
                }
            if (!AllDrawLoad)
            {
                AllDraw.TableListAction.Add(Table);
            }
            for (int i = 0; i < 8; i++)
            {
                Draw.SolderesOnTable[i] = new DrawSoldier(i, 1, Color.Gray, Table, 1, false, i);
            }
            for (int i = 8; i < 16; i++)
            {
                Draw.SolderesOnTable[i] = new DrawSoldier(i - 8, 6, Color.Brown, Table, -1, false, i);
            }
            Draw.ElephantOnTable[0] = new DrawElefant(2, 0, Color.Gray, Table, 1, false, 0);
            Draw.ElephantOnTable[1] = new DrawElefant(5, 0, Color.Gray, Table, 1, false, 1);
            Draw.ElephantOnTable[2] = new DrawElefant(2, 7, Color.Brown, Table, -1, false, 2);
            Draw.ElephantOnTable[3] = new DrawElefant(5, 7, Color.Brown, Table, -1, false, 3);

            Draw.HoursesOnTable[0] = new DrawHourse(1, 0, Color.Gray, Table, 1, false, 0);
            Draw.HoursesOnTable[1] = new DrawHourse(6, 0, Color.Gray, Table, 1, false, 1);
            Draw.HoursesOnTable[2] = new DrawHourse(1, 7, Color.Brown, Table, -1, false, 2);
            Draw.HoursesOnTable[3] = new DrawHourse(6, 7, Color.Brown, Table, -1, false, 3);

            Draw.BridgesOnTable[0] = new DrawBridge(0, 0, Color.Gray, Table, 1, false, 0);
            Draw.BridgesOnTable[1] = new DrawBridge(7, 0, Color.Gray, Table, 1, false, 1);
            Draw.BridgesOnTable[2] = new DrawBridge(0, 7, Color.Brown, Table, -1, false, 2);
            Draw.BridgesOnTable[3] = new DrawBridge(7, 7, Color.Brown, Table, -1, false, 3);

            Draw.KingOnTable[0] = new DrawKing(3, 0, Color.Gray, Table, 1, false, 0);
            Draw.KingOnTable[1] = new DrawKing(3, 7, Color.Brown, Table, -1, false, 1);

            Draw.MinisterOnTable[0] = new DrawMinister(4, 0, Color.Gray, Table, 1, false, 0);
            Draw.MinisterOnTable[1] = new DrawMinister(4, 7, Color.Brown, Table, -1, false, 1);


            AllDraw.TableListAction.Add(Table);
            if (MovmentsNumber == 0)
            {
                for (int i = 0; i < 8; i++)
                    for (int j = 0; j < 8; j++)
                        Table[i, j] *= -1;
            }
            Draw.TableList.Clear();
            Draw.TableList.Add(Table);
            Draw.SetRowColumn(0);
            //TakeRoot.CalculateRootGray(Draw);
        }
        //Acccess Point
        public AllDraw accessDraw
        {
            get { return Draw; }
            set { Draw = value; }

        }
        //Syncronization Between Class Dlls.
        private void SetTimer()
        {
            do
            {
                //while (!StateCC && !StateCP && !StateGe)
                Thread.Sleep(50);
                Refrigtz.Timer.AStarGreadyFirstSearch = AllDraw.AStarGreadyFirstSearch;
                Refrigtz.Timer.AStarGreedytiLevelMax = AllDraw.AStarGreedyiLevelMax;
                Refrigtz.Timer.UseDoubleTime = AllDraw.UseDoubleTime;
                Refrigtz.Timer.StoreAllDrawCount = AllDraw.StoreADraw.Count;
            }
            while (true);

        }

        //Boolean Setting of Illustration at Slected Object Rules.
        bool[,] VeryFye(int[,] Table, int Order, Color a)
        {
            int Cdummy = ChessRules.CurrentOrder;
            if (OrderPlate == 1)
                ChessRules.CurrentOrder = 1;
            else
                ChessRules.CurrentOrder = -1;
            bool[,] Tab = new bool[8, 8];
            for (int i = 0; i < 8; i++)
                for (int j = 0; j < 8; j++)
                {
                    if ((new ChessRules(Table[(int)RowClickP, (int)ColumnClickP], Table, Order, (int)RowClickP, (int)ColumnClickP)).Rules((int)RowClickP, (int)ColumnClickP, i, j, a, Table[(int)RowClickP, (int)ColumnClickP]))
                    {
                        Tab[i, j] = true;
                    }
                }
            ChessRules.CurrentOrder = Cdummy;
            return Tab;
        }
           //Load Refregitz Form.
        //Reading Table Database.
            
        //The State of Alice with Person Thinking.
        void AliceWithPerson()
        {

            ThinkingChess.ThinkingRun = true;

            try
            {
            Begin1:
                bool StoreStateCC = StateCC;
                bool StoreStateCP = StateCP;
                bool StoreStateGe = StateGe;
                StateCC = false;
                StateCP = false;
                StateGe = false;

                MovmentsNumber++;

                ////SetBoxText("\r\n Movments Number " + MovmentsNumber.ToString() + " is Brown OrderPlate!");
                ////RefreshBoxText();();

                ////SetBoxText("\r\nThinking Begin!");
                ////RefreshBoxText();();
                Color a = Color.Gray;
                if (OrderPlate == -1)
                    a = Color.Brown;
                Draw.Initiate(1, 4, a, Table, OrderPlate, false);
                //this.//SetBoxText("\r\nThinking Finished!");
                Draw.SetRowColumn(0);
                int[,] TableCon = new int[8, 8];
                for (int i = 0; i < 8; i++)
                    for (int j = 0; j < 8; j++)
                        TableCon[i, j] = Table[i, j];
                AllDraw.TableListAction.Add(TableCon);
                if (AllDraw.TableListAction.Count > 1)
                {
                    ChessGeneticAlgorithm R = new ChessGeneticAlgorithm();
                    if (R.FindGenToModified(AllDraw.TableListAction[AllDraw.TableListAction.Count - 2], AllDraw.TableListAction[AllDraw.TableListAction.Count - 1], AllDraw.TableListAction, 0, OrderPlate, true))
                    {
                        bool HitVal = false;
                        int Hit = AllDraw.TableListAction[AllDraw.TableListAction.Count - 2][R.CromosomRow, R.CromosomColumn];
                        if (Hit != 0)
                            HitVal = true;
                        bool Convert = false;
                        if (OrderPlate == 1)
                        {
                            if (AllDraw.TableListAction[AllDraw.TableListAction.Count - 1][R.CromosomRow, R.CromosomColumn] == 1)
                            {
                                if (R.CromosomColumn == 7)
                                    Convert = true;
                            }
                            if ((ChessRules.SmallKingBridgeGray || ChessRules.BigKingBridgeGray) && (!ChessRules.BridgeActGray))
                                ChessRules.BridgeActGray = true;
                            AllDraw.SyntaxToWrite = (new ChessRules()).CreateStatistic(Table, MovmentsNumber + 1, AllDraw.TableListAction[AllDraw.TableListAction.Count - 2][R.CromosomRowFirst, R.CromosomColumnFirst], R.CromosomColumn, R.CromosomRow, HitVal, Hit, ChessRules.BridgeActGray, Convert);
                        }
                        else
                        {
                            if (AllDraw.TableListAction[AllDraw.TableListAction.Count - 1][R.CromosomRow, R.CromosomColumn] == -1)
                            {
                                if (R.CromosomColumn == 0)
                                    Convert = true;
                            }
                            if ((ChessRules.SmallKingBridgeBrown || ChessRules.BigKingBridgeBrown) && (!ChessRules.BridgeActBrown))
                                ChessRules.BridgeActBrown = true;

                            AllDraw.SyntaxToWrite = (new ChessRules()).CreateStatistic(Table, MovmentsNumber + 1, AllDraw.TableListAction[AllDraw.TableListAction.Count - 2][R.CromosomRowFirst, R.CromosomColumnFirst], R.CromosomColumn, R.CromosomRow, HitVal, Hit, ChessRules.BridgeActBrown, Convert);
                        }
                        //SetBoxStatistic(AllDraw.SyntaxToWrite);
                        //RefreshBoxStatistic();
                    }
                }
                OrderPlate = OrderPlate * -1;
                ChessRules.CurrentOrder = OrderPlate;

                BrownTimer.StopTime();
                GrayTimer.StartTime();

          
                
                Person = true;
                StateCC = StoreStateCC;
                StateCP = StoreStateCP;
                StateGe = StoreStateGe;
                ThinkingChess.ThinkingRun = false;
                if (SettingPRFALSE)
                {
                    SettingPRFALSE = false;
                   
                }
            }
            catch (Exception t)
            {
                
                //this.//SetBoxText("\r\nError!");
            }
        }
        //The State of Bob with Person Thinking.
        bool TableZero(int[,] Ta)
        {
            bool NotZerro = false;
            for (int i = 0; i < 8; i++)
                for (int j = 0; j < 8l; j++)
                    if (Ta[i, j] != 0)
                        NotZerro = true;
            return NotZerro;
        }
        //Alice Section of Computer by Computer Thinking.
        //Bob Section of Computer By Computer Thinking.
        
    }
  

}

//End of Documentation.




